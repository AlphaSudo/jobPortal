<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Explore Jobs</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    .filter-sidebar {
      position: sticky;
      top: 20px;
    }
    .carousel-inner img {
      height: 300px;
      object-fit: cover;
    }
  </style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="#">JobPortal</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">

          <li class="nav-item" th:if ="${authenticatedUser.userType == 'ROLE_SEEKER'}">
            <!--        <img th:src="@{${jobSeeker.photo}}" alt="profile image" style="width: 50px; height: 50px; border-radius: 50%;">-->
            <!--        <img th:src="@{${jobSeeker?.thumbnail}}" alt="thumbnail image" style="width: 50px; height: 50px; border-radius: 50%;">-->
            <!--        <img id="profileImage" th:src="@{${jobSeeker.photo}}" alt="profile image" style="width: 50px; height: 50px; border-radius: 50%;">-->
            <img id="profileImage" src="" alt="profile image" style="width: 50px; height: 50px; border-radius: 50%;">

          </li>
            <li class="nav-item" th:if="${authenticatedUser.userType == 'ROLE_RECRUITER'}">
                <img id="profileImage1" src="" alt="profile image3" style="width: 50px; height: 50px; border-radius: 50%;">

            </li>

          <li class="nav-item" th:if="${ authenticatedUser.userType == 'ROLE_SEEKER'}">
            <select class="form-select profile-options" aria-label="Default select example">
              <option selected>Profile</option>
              <option th:text="${jobSeeker.firstName} + ' ' + ${jobSeeker.lastName}" th:value="'profile'"></option>
              <option th:text="${jobSeeker.photo}" th:value="'profile'"></option>
              <option th:text="@{${jobSeeker.photo}}" th:value="'profile'"></option>
              <option th:text="${isFirstTimeProfileSetup}" th:value="'profile'"></option>
              <!--          <option th:text="${uploadedImageBase64}" th:value="'profile'"></option>-->
              <option value="logout">Sign Out</option>
            </select>
          </li>
          <li class="nav-item" th:if="${authenticatedUser.userType == 'ROLE_RECRUITER'}">
            <select class="form-select profile-options" aria-label="Default select example">
              <option selected>Profile</option>
              <option th:text="${recruiter.firstName}" th:value="'profile'"></option>
              <option th:text="${recruiter.companyName}" th:value="'profile'"></option>
              <option value="logout">Sign Out</option>
            </select>
            </li>
        </ul>
  </div>
</nav>

<!-- Hero Section -->
<section class="hero text-center">
  <div class="container">
    <!--    <div th:if="${#request.isUserInRole('ROLE_JOB_SEEKER')}" class="alert alert-success" role="alert">-->
    <!--      Welcome back, <strong th:text="${jobSeeker.firstName} + ' ' + ${jobSeeker.lastName}"></strong>!-->
    <!--    </div>-->
    <!--    <div th:if="${#request.isUserInRole('ROLE_RECRUITER')}" class="alert alert-success" role="alert">-->
    <!--      Welcome back, <strong th:text="${recruiter.companyName}"></strong>!-->
    <!--    </div>-->
    <!--    <div th:if="${successMessage}" class="alert alert-success" role="alert">-->
    <!--      <span th:text="${successMessage}"></span>-->
    <!--    </div>-->
    <h1 class="display-4">Explore Your Next Job</h1>
    <p class="lead">Find the perfect job that matches your passion and skill.</p>
    <input type="text" class="form-control mt-4" placeholder="Search jobs, companies, skills..." aria-label="Job Search">
    <button class="btn btn-primary mt-2">Search</button>
  </div>
</section>

<div class="container my-5">
  <div class="row">
    <!-- Filters Sidebar -->
    <div class="col-md-3">
      <div class="filter-sidebar bg-light p-3 rounded">
        <h4>Filters</h4>
        <div class="form-group">
          <label>Job Category</label>
          <label>
            <select class="form-control">
              <option>All</option>
              <option>Engineering</option>
              <option>Marketing</option>
              <option>Finance</option>
              <option>Design</option>
            </select>
          </label>
        </div>
        <div class="form-group">
          <label>Location</label>
          <label>
            <select class="form-control">
              <option>All</option>
              <option>Cairo</option>
              <option>Alexandria</option>
              <option>Giza</option>
            </select>
          </label>
        </div>
        <div class="form-group">
          <label>Experience Level</label>
          <label>
            <select class="form-control">
              <option>All</option>
              <option>Internship</option>
              <option>Entry Level</option>
              <option>Mid Level</option>
              <option>Senior Level</option>
            </select>
          </label>
        </div>
        <button class="btn btn-primary btn-block mt-3">Apply Filters</button>
      </div>
    </div>

    <!-- Job Listings -->
    <div class="col-md-9">
      <!-- Job Suggestion Carousel -->
      <h3>Suggested Jobs</h3>
      <div id="jobSuggestionCarousel" class="carousel slide mb-4" data-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="/uploads/seth.jpg" class="d-block w-100" alt="Job 1">
            <div class="carousel-caption d-none d-md-block">
              <h5>Software Engineer at TechCorp</h5>
              <p>Cairo, Egypt - Full Time</p>
            </div>
          </div>
          <div class="carousel-item">
            <img src="https://via.placeholder.com/800x300" class="d-block w-100" alt="Job 2">
            <div class="carousel-caption d-none d-md-block">
              <h5>Digital Marketer at MarketGuru</h5>
              <p>Giza, Egypt - Part Time</p>
            </div>
          </div>
        </div>
        <a class="carousel-control-prev" href="#jobSuggestionCarousel" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#jobSuggestionCarousel" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>

      <!-- Job Cards -->
      <h3>Available Jobs</h3>
      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="card job-card">
            <div class="card-body">
              <h5 class="card-title">Frontend Developer</h5>
              <h6 class="card-subtitle mb-2 text-muted">InnovateTech</h6>
              <p class="card-text">Cairo, Egypt - Full Time</p>
              <button class="btn btn-primary">Apply Now</button>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="card job-card">
            <div class="card-body">
              <h5 class="card-title">Product Designer</h5>
              <h6 class="card-subtitle mb-2 text-muted">CreativeHub</h6>
              <p class="card-text">Alexandria, Egypt - Remote</p>
              <button class="btn btn-primary">Apply Now</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Company Spotlight -->
  <div class="company-spotlight mt-5">
    <h3>Company Spotlight</h3>
    <p>Learn more about our featured company of the month, <strong>StarTech Solutions</strong>. They are currently hiring for multiple roles, including developers, designers, and project managers.</p>
    <button class="btn btn-outline-primary">Explore Jobs at StarTech</button>
  </div>
</div>

<!-- Bootstrap & jQuery JavaScript -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!--<script th:inline="javascript">-->
<script  th:inline="javascript">
  console.log('step1')

  document.addEventListener('DOMContentLoaded', function () {
    document.querySelector('.profile-options').addEventListener('change', function () {
      if (this.value === 'logout') {
        window.location.href = '/login?logout';
      }
    });

    console.log('step3')


    let notDoneYet = /*[[${notDoneYet}]]*/ 0;
    console.log('step6')
    let role = /*[[${authenticatedUser.userType}]]*/ '';
    console.log('step7')



    if (role === 'ROLE_SEEKER') {
      console.log('step4')
      const base64Image = /*[[${uploadedImageBase64}]]*/ '';
      let base64I = /*[[${base64}]]*/ '';
      console.log('step5')
      console.log('step9')

      let isFirstTimeProfileSetup = /*[[${isFirstTimeProfileSetup}]]*/ 0;
        let jobSeekerPhoto = /*[[${jobSeeker.photo}]]*/ '';
      if (isFirstTimeProfileSetup === 1) {
        console.log('step11')
        document.getElementById('profileImage').src = 'data:image/jpeg;base64,' + base64Image;
        console.log('role: ' + role);
        console.log('[1] photo from base 64  first time  ');
      } else if (notDoneYet === 1) {
        console.log('step12')
        document.getElementById('profileImage').src = 'data:image/jpeg;base64,' + base64I;
        console.log('[2] photo from base 64 after 2 minutes');
      } else {console.log('step13')
        document.getElementById('profileImage').src = jobSeekerPhoto;
        console.log('[3]Job Seeker photo from server.');
        console.log('Job Seeker photo: ' + jobSeekerPhoto);
      }
    } else {
   console.log('step14')
        let recruiter = /*[[${recruiter.profilePic}]]*/ '';
        let base64q = /*[[${base64q}]]*/ '';
        console.log('step8')
        console.log('step15')
         if (notDoneYet === 1) {console.log('step17')
        document.getElementById('profileImage1').src = 'data:image/jpeg;base64,' + base64q;
        console.log('[2] photo from base 64  after 2 minutes ');
      } else {console.log('step18')
        document.getElementById('profileImage1').src = recruiter;
        console.log('[3]Recruiter photo from server.');
        console.log('Recruiter photo: ' + recruiter);
      }
    }


  });



</script>
</body>
</html>